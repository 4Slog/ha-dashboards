title: Family
path: family
icon: mdi:map-marker-account
panel: true
theme: default

cards:
  - type: custom:layout-card
    layout_type: custom:grid-layout
    layout:
      grid-template-columns: 1fr
      grid-auto-rows: min-content
      justify-content: stretch
      align_content: start
      gap: 16px
      padding: 16px

    cards:
      # === HEADER (NAV + DATE/TIME) ===
      - !include components/header-family.yaml

      # === FAMILY LOCATION BANNER ===
      - type: custom:button-card
        name: FAMILY LOCATION
        icon: mdi:map-marker-account
        show_name: true
        show_icon: true
        tap_action:
          action: none
        styles:
          card:
            - height: 30px
            - border-radius: 8px
            - background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)
            - box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3)
            - padding: 0 12px
          grid:
            - grid-template-areas: '"i n"'
            - grid-template-columns: auto 1fr
          icon:
            - width: 18px
            - height: 18px
            - color: white
            - margin-right: 8px
          name:
            - font-size: 1.1rem
            - font-weight: 700
            - color: white
            - justify-self: start
            - letter-spacing: 0.5px
        card_mod:
          style: |
            @media (max-width: 1400px) {
              ha-card { height: 26px !important; }
              ha-card .name { font-size: 0.95rem !important; }
            }

      # === 3 PERSON CARDS ===
      - type: custom:layout-card
        layout_type: custom:grid-layout
        layout:
          grid-template-columns: repeat(3, 1fr)
          gap: 16px
        card_mod:
          style: |
            @media (max-width: 1400px) { ha-card { --gap: 10px; } }
        cards:
          # PAUL
          - type: custom:button-card
            entity: person.paul
            name: Paul
            show_entity_picture: true
            show_name: true
            show_state: false
            custom_fields:
              battery: |
                [[[
                  const tracker = states['device_tracker.paul_360'];
                  if (tracker && tracker.attributes.battery_level) {
                    const charging = tracker.attributes.battery_charging ? '‚ö°' : 'üîã';
                    return `<span style="font-size: 1.1rem;">${charging} ${tracker.attributes.battery_level}%</span>`;
                  }
                  return '';
                ]]]
              status: |
                [[[
                  const tracker = states['device_tracker.paul_360'];
                  if (!tracker) return '';
                  if (tracker.state === 'home') return `<span style="font-size: 1.3rem; font-weight: 600;">üè† Home</span>`;
                  if (tracker.attributes.driving) return `<span style="font-size: 1.3rem; font-weight: 600;">üöó Driving</span>`;
                  return `<span style="font-size: 1.3rem; font-weight: 600;">üìç Away</span>`;
                ]]]
            styles:
              card:
                - height: 260px
                - border-radius: 16px
                - background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)
                - box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3)
                - padding: 16px
              grid:
                - grid-template-areas: '"i" "n" "battery" "status"'
                - grid-template-rows: 100px auto auto 1fr
              img_cell:
                - width: 100px
                - height: 100px
                - border-radius: 50%
                - border: 3px solid white
                - justify-self: center
                - margin-bottom: 8px
              name:
                - font-size: 1.5rem
                - font-weight: 700
                - color: white
                - justify-self: center
                - margin-bottom: 8px
              custom_fields:
                battery:
                  - justify-self: center
                  - color: white
                  - margin-bottom: 8px
                status:
                  - justify-self: center
                  - color: white
                  - text-align: center
            card_mod:
              style: |
                @media (max-width: 1400px) {
                  ha-card { height: 200px !important; padding: 10px !important; border-radius: 12px !important; }
                  ha-card .name { font-size: 1.2rem !important; }
                }

          # TUELLA
          - type: custom:button-card
            entity: person.tuella_sowu
            name: Tuella
            show_entity_picture: true
            show_name: true
            show_state: false
            custom_fields:
              battery: |
                [[[
                  const tracker = states['device_tracker.tuella_360'];
                  if (tracker && tracker.attributes.battery_level) {
                    const charging = tracker.attributes.battery_charging ? '‚ö°' : 'üîã';
                    return `<span style="font-size: 1.1rem;">${charging} ${tracker.attributes.battery_level}%</span>`;
                  }
                  return '';
                ]]]
              status: |
                [[[
                  const tracker = states['device_tracker.tuella_360'];
                  if (!tracker) return '';
                  if (tracker.state === 'home') return `<span style="font-size: 1.3rem; font-weight: 600;">üè† Home</span>`;
                  if (tracker.attributes.driving) return `<span style="font-size: 1.3rem; font-weight: 600;">üöó Driving</span>`;
                  return `<span style="font-size: 1.3rem; font-weight: 600;">üìç Away</span>`;
                ]]]
            styles:
              card:
                - height: 260px
                - border-radius: 16px
                - background: linear-gradient(135deg, #fa709a 0%, #fee140 100%)
                - box-shadow: 0 4px 12px rgba(250, 112, 154, 0.3)
                - padding: 16px
              grid:
                - grid-template-areas: '"i" "n" "battery" "status"'
                - grid-template-rows: 100px auto auto 1fr
              img_cell:
                - width: 100px
                - height: 100px
                - border-radius: 50%
                - border: 3px solid white
                - justify-self: center
                - margin-bottom: 8px
              name:
                - font-size: 1.5rem
                - font-weight: 700
                - color: white
                - justify-self: center
                - margin-bottom: 8px
              custom_fields:
                battery:
                  - justify-self: center
                  - color: white
                  - margin-bottom: 8px
                status:
                  - justify-self: center
                  - color: white
                  - text-align: center
            card_mod:
              style: |
                @media (max-width: 1400px) {
                  ha-card { height: 200px !important; padding: 10px !important; border-radius: 12px !important; }
                  ha-card .name { font-size: 1.2rem !important; }
                }

          # MAURIECE
          - type: custom:button-card
            entity: person.mauriece
            name: Mauriece
            show_entity_picture: true
            show_name: true
            show_state: false
            custom_fields:
              battery: |
                [[[
                  const tracker = states['device_tracker.mauriece_360'];
                  if (tracker && tracker.attributes.battery_level) {
                    const charging = tracker.attributes.battery_charging ? '‚ö°' : 'üîã';
                    return `<span style="font-size: 1.1rem;">${charging} ${tracker.attributes.battery_level}%</span>`;
                  }
                  return '';
                ]]]
              status: |
                [[[
                  const tracker = states['device_tracker.mauriece_360'];
                  if (!tracker) return '';
                  if (tracker.state === 'home') return `<span style="font-size: 1.3rem; font-weight: 600;">üè† Home</span>`;
                  if (tracker.attributes.driving) return `<span style="font-size: 1.3rem; font-weight: 600;">üöó Driving</span>`;
                  return `<span style="font-size: 1.3rem; font-weight: 600;">üìç Away</span>`;
                ]]]
            styles:
              card:
                - height: 260px
                - border-radius: 16px
                - background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)
                - box-shadow: 0 4px 12px rgba(79, 172, 254, 0.3)
                - padding: 16px
              grid:
                - grid-template-areas: '"i" "n" "battery" "status"'
                - grid-template-rows: 100px auto auto 1fr
              img_cell:
                - width: 100px
                - height: 100px
                - border-radius: 50%
                - border: 3px solid white
                - justify-self: center
                - margin-bottom: 8px
              name:
                - font-size: 1.5rem
                - font-weight: 700
                - color: white
                - justify-self: center
                - margin-bottom: 8px
              custom_fields:
                battery:
                  - justify-self: center
                  - color: white
                  - margin-bottom: 8px
                status:
                  - justify-self: center
                  - color: white
                  - text-align: center
            card_mod:
              style: |
                @media (max-width: 1400px) {
                  ha-card { height: 200px !important; padding: 10px !important; border-radius: 12px !important; }
                  ha-card .name { font-size: 1.2rem !important; }
                }

      # === MAP ===
      - type: custom:layout-card
        layout_type: custom:grid-layout
        layout:
          grid-template-columns: 15% 70% 15%
          gap: 0
        card_mod:
          style: |
            @media (max-width: 1400px) {
              ha-card { --grid-template-columns: 10% 80% 10%; }
            }
        cards:
          - type: custom:button-card
            color_type: blank-card
            styles:
              card:
                - background: transparent
                - box-shadow: none

          - type: map
            entities:
              - person.paul
              - person.tuella_sowu
              - person.mauriece
              - zone.home
            hours_to_show: 0.5
            default_zoom: 15
            dark_mode: true
            card_mod:
              style: |
                ha-card {
                  aspect-ratio: 1 / 1;
                  border-radius: 16px;
                  border: 3px solid rgba(102, 126, 234, 0.5);
                  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
                  overflow: hidden;
                }
                @media (max-width: 1400px) {
                  ha-card {
                    aspect-ratio: 16 / 9;
                    border-radius: 12px;
                  }
                }

          - type: custom:button-card
            color_type: blank-card
            styles:
              card:
                - background: transparent
                - box-shadow: none
